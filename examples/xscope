#! /usr/bin/env coffee

program = require('commander')
xscope  = require('..')

program
  .option('--firmware', 'read firmware version')
  .option('--fake', 'use fake usb module')
  .version('0.0.1')
  .parse(process.argv)

if program.fake
  usb = require('../fake/usb')
  usb.configure { findDevice: true }
else
  usb = require('usb')


driver = new xscope.Driver(usb)

driver.open()
.then( () ->
  driver.getFirmwareVersion()
).then( (data) ->
  console.log 'firmware version', data.toString()
).done()
